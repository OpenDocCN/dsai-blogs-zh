# 用 Kuba Cieś lik 构建可视化搜索引擎

> 原文：<https://web.archive.org/web/https://neptune.ai/blog/building-visual-search-engines-with-kuba-cieslik>

这篇文章最初是 MLOps Live(T1)的一集，这是一个互动的 Q(T2)环节，在这里，ML 从业者回答来自其他 ML 从业者的问题。

每集都专注于一个特定的人工智能主题，在这一集里，我们采访了 Kuba Cieś lik， [tuul.ai](https://web.archive.org/web/20230117113021/https://www.tuul.ai/) 的创始人兼人工智能工程师，讨论了**构建视觉搜索引擎的问题。**

你可以在 YouTube 上观看:

[https://web.archive.org/web/20230117113021if_/https://www.youtube.com/embed/YFEGsm2XAVM?start=5&feature=oembed](https://web.archive.org/web/20230117113021if_/https://www.youtube.com/embed/YFEGsm2XAVM?start=5&feature=oembed)

视频

或者作为播客在以下位置收听:

但如果你更喜欢书面版本，这里有！

您将了解到:

## 1 什么是视觉搜索？

*   2 视觉搜索和 OCR 有什么不同？
*   设计视觉搜索引擎时要记住的事情
*   视觉搜索中嵌入的重要性
*   5 视觉搜索引擎评测
*   将视觉搜索引擎与其他产品整合
*   7 构建可视化搜索引擎的基本工具栈
*   8 扩展视觉搜索系统
*   9 …还有更多！
*   好吧，我们开始吧。

**萨宾:**大家好。欢迎来到 [*飞行大队李* ve](/web/20230117113021/https://neptune.ai/events) 。我叫萨宾，和我一起的是我的搭档主持人斯蒂芬。这是今天与我们嘉宾的互动问答环节，他是构建视觉搜索引擎的专家。首先，我很荣幸向您介绍我们的嘉宾，机器学习和数据科学工程师 [Kuba Cieslik](https://web.archive.org/web/20230117113021/https://www.linkedin.com/in/jakubcieslik/) 。欢迎你库巴。你愿意简单介绍一下自己吗？

**库巴:**当然可以。大家好。很高兴能参加这个活动。我是一名机器学习工程师，在构建 ML 产品和 ML 解决方案方面有几年的经验。碰巧的是，在过去的一两年里，我专注于构建视觉搜索解决方案，总的来说，计算机视觉是我在这个领域感兴趣的主要话题。

萨宾:你现在在做什么事情？

目前，我正在研究一个非常有趣的话题，至少，每当我把这个话题告诉别人时，都会激起一些兴趣。本质上，我在研究动物的面部识别。你可以想象自己在用手机，它能认出你。现在所有的手机都有这种功能，它们可以根据摄像头或面部摄像头识别你，本质上是我们试图为动物建立的类似功能，在这种情况下，跟踪动物变得更加重要。

在某些情况下，使用 NFC 标签等其他技术手段并记下现在正在使用的东西是不实际的，不管出于什么原因，我们现在已经有了这种技术，或者我们希望将这种技术提高到我们能够从单张或多张照片中识别动物个体的水平。

什么是视觉搜索？

## 萨宾:好吧，很酷。不是让你为难，但如果可能的话，我们希望你能在一分钟内解释一下视觉搜索。这是一个挑战。

**库巴:**对我来说，我会把这个问题当成任何搜索问题。

每当我们想到搜索某样东西时，我们都想检索相关信息，通常，这是通过文本来完成的，至少，这是我们习惯的方式，或者我们习惯的方式，但本质上，视觉搜索只是这个问题的一个子集，它使用特定的视觉信息。它可以是视频，可以是图像，可以是图画，不管它是什么，对人类来说，它是一个视觉的东西。这就是问题所在。

> 萨宾:好吧。我认为那确实在一分钟之内。干得好。

视觉搜索引擎用例

## **Stephen:** 很有意思，库巴，你在视觉搜索和搜索引擎方面的想法。我就从高层次来说，你今天看到的人们通常使用的视觉搜索引擎的一些例子是什么，他们不知道它背后的技术是什么？

我认为这项技术现在开始越来越流行，而且也越来越好。例如，我认为这种技术带来惊人效果的主要例子实际上是谷歌镜头，这是最常用的，也可能是最先进的技术，当然，这是一种非常重要的销售方式和营销方式。你基本上可以指向任何东西并给它拍照，谷歌会试图找到它并把你重定向到你能买到它们的地方，当然，这是开发它的一个非常重要的原因，但还有其他事情。

肯定有所有这些视觉搜索引擎，Pinterest 非常擅长这一点，本质上他们围绕这种只是去看看的沉浸式感觉建立了一个产品，你不必键入 match，你只需点击任何对你有吸引力的东西，然后它会尝试向你建议你可能想要的东西，因为最终，意图是非常微妙的。

当你搜索一张图片时，很难理解它的意图。你对图案感兴趣吗？你是对这个物体本身感兴趣，还是可能是完全不同的东西？通常，为了用视觉搜索做出好的搜索，你通常还需要一些关于用户想要什么的上下文。

> 我会说。但是，当然，就像其他光谱上的其他事物一样，比如面部识别，它们是完全不同的，在那里你本质上只有一个有效的答案，你有一个验证或识别问题，这项技术依赖于问题的另一个光谱，但是用来解决它的技术实际上是非常相似的。

视觉搜索和 OCR 有什么不同？

## 斯蒂芬:好的。仍然在高层次上，再次，我认为视觉搜索引擎的方式，我认为更像是不同技术的组合，这可能像 OCR 技术，所有这些技术。我这样想是不是错了，或者有哪些不同的技术实际上可以组成一个可视化搜索引擎？

**Kuba:** 我不确定我是否明白你的意思，但我认为在组合多个东西方面，那么往往你想要的实际上是使用多模态信息，你也使用提供的文本，这是上下文信息，然后搜索，然后是视觉部分本身。我不确定，也许你可以就这个问题详细说明一下。

斯蒂芬:好的。我的意思是，比如 Google Lens，我们把 Google Lens 也算进去吧。当我想到 Google lens 时，作为一个初学者，当然，我会将 Google 视为后台发生的一些 OCR 类型的技术。我们是不是说，为了建立一个合适的视觉搜索引擎，必须有 OCR 技术，然后必须有一些视觉技术？

**Kuba:** 我认为 OCR 对许多解决方案都很重要，例如，也许你们中的一些人知道有一个叫 Vivino 的应用程序用于葡萄酒标签扫描，你可以通过两种方式来完成，你可以解决将葡萄酒瓶与你想要找到的实际瓶子相匹配的问题，你可以通过 OCR 技术来帮助自己，所以实际上阅读瓶子上的文字可以帮助你，对吗？

如果有一些文本，可能会这样，但是当然，有没有文本的标签，并且在大多数情况下，拥有组合解决方案或后备解决方案是非常重要的。这就是我所说的，当我说这很少是一个纯粹的视觉问题时，通常是一个视觉加一些东西的问题，大多数情况下，不像那些识别验证问题，实际上没有任何其他背景。

斯蒂芬:好吧。明确一下，视觉搜索技术和 OCR 技术的区别就在于它的上下文，理解图像的上下文，是吗？

**库巴:**是的。嗯，实际上是看图像，因为 OCR 只是用来实际查找文本，然后尝试对文本做一些事情。当我们训练模型通过视觉理解来对网络进行视觉理解时，我们想要的不仅仅是这些，我们想要在图像中找到特征，找到联系，这些图像不是那么清晰，也不可能用文本来描述。更重要的是，我们没有世界上大多数图像的文字。

什么是三联网络培训？

## **Sabine:** 好的，我想我们有空间回答来自社区的问题。这对我来说是新的。这些三元网络你的基线三元网络训练是什么？使用它时，人们可能希望注意什么？

**库巴:**三连音训练是一种特殊类型的公制学习。这是度量学习的一部分，我们试图学习一个度量函数，这通常是通过比较两个事物来实现的。例如，对于人脸，我们可以训练这样的模型，你展示一个网络，就像同一个人的两张照片和另一个人的第三张照片，然后一个模型将学习在同一个人的一些空间中保持接近图像，并将其推离其他图像。

实际上有很多很好的框架，我想到的是——特别是在 [PyTorch](https://web.archive.org/web/20230117113021/https://pytorch.org/) 中，我用得最多的是 PyTorch 度量学习，是的，它实际上实现了新解决方案步骤中的大多数创新，你可能会——新论文或新损失函数，无论你想要什么。我真的推荐它，它非常好，也许我们稍后会添加一个链接，但它会在那里。

设计视觉搜索引擎:要记住的事情

## Sabine: 你有什么关于视觉搜索的小技巧吗，比如清单之类的？

**库巴:**对，一个清单。我想我真的会弄清楚问题到底是什么，正在解决什么，以及如何设置它，因为有些事情我们可能想从学习三重学习网络中学习，有些事情我们可能需要从纯无人监督的方式或从排名标签中学习。我认为，最终，它归结为从图像中学习有意义的特征的问题，以及这些特征实际上应该是什么，因为这是非常具体的问题，对吗？

很多时候，搜索引擎就像是通过一个预先训练好的网络传递一些图像，然后从中产生的特征会对这个数据样本进行聚类，这是真的，但如果它按照你认为它应该的方式进行聚类，那就是另一回事了，对吗？例如，如果网络是在 1000 个类上训练的，我的意思是，它在对不同类型的对象进行分组方面很好，但在区分它们方面不会很好，所以使用这种预训练网络的模型可能不是最棒的，例如，对相似的服装进行排序或试穿，这么说是因为它从未真正理解不同类型服装的概念。

它可能仍然非常有用，但大多数时候，我们想要从中获得的这种类型的附加信息，至少需要新的数据和附加标签。这是棘手的部分，这将是主要的考虑因素，但当然，如果我们对某个问题了解得更多，那么我们就可以想得更多。

**Sabine:** 但你仍然会根据新数据对预训练进行微调，对吗？

**库巴:**可以，当然可以，可以。使用预先训练好的网络几乎总是可行的，对吗？而不是从零开始，所以这是肯定的。

嵌入在视觉搜索中的重要性

## 斯蒂芬:库巴，我很想插话。我认为嵌入在这个领域非常非常重要，当然，在构建可视化搜索引擎的时候。在你看来，在处理视觉搜索引擎技术时，好的和主题相关的嵌入的重要性是什么？

Kuba: 我认为这只是我之前所说的一点，即它是针对特定问题的，尽管一些非常通用的搜索引擎可能看起来不是这样，但如果我们想要建立非常具体的解决方案，我认为这就是现在正在使用的方法。例如，如果我们想要对时尚有好的建议，那么我们需要专注于它，甚至非常具体地专注于某一种服装类型，以使它正确。

举个例子，在我的工作中，同样的事情发生了，如果你只是使用预先训练好的网络来做牛脸的嵌入，那么它根本就不能工作，对吧，因为这样的网络没有理由去学习区分一个牛和另一个牛的东西，人脸也是一样。这就像我们现在拥有的运作良好的 Face ID 技术。

它之所以有效，是因为它是在十亿张脸上训练过的，所以这就是为什么它是相关的。这并不像你有一个神奇的方法来创建一个在各种情况下都能很好工作的嵌入，你需要以某种方式控制它。

为视觉搜索训练良好的嵌入

### 斯蒂芬:是的，我只是很快地跟进一下，这些情况下你有标签，你在面部训练，你有标签。我认为有相当多的用例，你不能像你希望的那样访问标签。在没有标签的情况下，你如何训练一个非常好的嵌入？

**库巴:**有，无标签。是的，这是个好问题。没有标签，当然，你的选择有限，对不对？假设您有一个用例，与您通常在数据集中找到的图像相比，它非常新。例如，来自工厂的东西可能是一些数据量有限的用例，那么我认为当前的方法，特别是在不断增长的自我监督学习领域，在这里非常有帮助。

你实际上可以用一种自我监督的方式来改进嵌入和训练嵌入。本质上，你只需要收集数据，然后网络，有不同类型的工作方式。自我监督学习是如何工作的。就像最直观的，最直观的方法一样，它们已经不怎么被使用了，但我认为出于解释的目的，它们更好。

> 例如，你训练一个在图像中显示间隙的网络。你切掉缺口，然后你告诉，“是的，缺口里有什么？”或者你让网络给图像上色，这也是你可以自我监督的事情，然后希望从中学习一些东西，但是新的方法，他们使用了一点更复杂的技术。举例来说，你基本上处理成对的图像，其中一个由于增强而有点畸形，然后你试图学习对于技术上不同的图像来说是相同的嵌入。

这对网络来说非常具有挑战性，因为它必须理解图像的内容。是的，用这样的嵌入进行训练，使用这样的嵌入，肯定会提高分数，或者不管你的问题是什么。是的，但这也有不好的一面。没有多少人大规模使用它，他们通常很难训练，自我监督的网络也没有融合。他们有很多诡计，我会说这是最后的手段。

视觉搜索引擎的评价

## 斯蒂芬:这看起来确实是一个很难解决的问题。评估过程是什么，你如何评估你训练的这个特定的模型或这个特定的问题，你在某种程度上满足了那些要求？

是的，我认为这尤其取决于你有什么问题。如果这是一个排名问题，那么，当然，你有一些方法给正在发生的事情打分。例如，我会假设视觉搜索，如 Pinterest 或 Google Lens，肯定可以标记它，并且可以有一些基本事实。你知道点击了什么或者用户点击了什么吗？在识别和再识别等领域，我们通常只使用最高的准确度。这是最重要的因素，因为如果你是一次性的，在大多数情况下，这是没有帮助的。没关系。很多时候，是不对的。这将是重要的事情。

将可视化搜索引擎与其他产品集成

## Lev 想知道，Kuba 是否认为以一种直观的方式将像 Google Lens 这样的视觉搜索与其他应用程序和产品集成已经恰当地发生了？有什么想法吗？

**Kuba:** 整合像谷歌镜头这样的东西，并制造一种产品，从本质上来说，我认为许多公司肯定会试图改善他们的购物体验，这肯定会发生，而且很流行。甚至像 H & M 这样的大型时尚公司也在他们的应用程序中加入了这一功能。当然，他们没有与谷歌镜头集成，他们有一些内置的解决方案来解决这个问题，但他们有一些解决方案让你扫描一些东西并查询他们的库存。这肯定会发生，这看起来是一个非常有效的用例，具有很高的价值，货币价值。

视觉搜索引擎在生产中的问题

## **Sabine:** 当你把视觉搜索用于生产时会怎么样？需要注意的是，你在那里面临的一些常见问题是什么？

当然，最大的问题之一是你需要意识到改变模型的成本是很高的，我认为，这比正常的机器学习的成本要高一些，因为正常的机器学习如果你改变了模型，那就是推荐。那么对于未来的推荐，你用一个新的模型，不一定要为了过去而改变，或者你为了过去而重新计算。

对于视觉搜索，每次你想使用一个新的模型，你必须重新计算所有图像的所有人员。想象一下，大规模地做这件事，我不知道，例如，谷歌是如何做的，或者他们的引擎多久做一次，或者如果有，我很难讲。这绝对是你需要注意的事情。

> 如果你改变模型，它将改变嵌入。然后他们大部分时间就变得不可比了。这是关键的一步，当然，还有一个大问题，特别是在大规模的应用程序中，就是数据库的大小。如果你在数百万张图片中进行查询，也许这没什么大不了的，但是在数千万张图片中进行查询可能会成为一个问题，并且可能会很快变得昂贵。

有很多方法可以缩小范围。你通常不需要也不想和所有的东西做比较。我敢肯定，如果我使用谷歌镜头，他们会给我安装一个特殊的过滤器，因为他们已经知道我的所有信息，他们不必扫描所有照片。是的，这绝对是非常非常关键的两件事。

构建时尚的可视化搜索引擎

## Sabine: 你自己有过为时尚构建可视化搜索引擎的经验吗？

**库巴:**是的。我研究了一些解决方案，试图从 Instagram 中挖掘信息。本质上，理解并建立一个可视化的搜索引擎，搜索我们从 Instagram 中挖掘的数据。这是一个非常有趣的用例，因为 instagram 通常是不可搜索的。你可以通过标签进行基本的搜索，仅此而已。如果你想在数百万或数千个 Instagram 个人资料中进行搜索，即使是基本的文本搜索也无法真正发挥作用。我们挖掘这些数据，然后通过一些管道进行可视化搜索。

例如，如果你想用某件衣服和一件衣服的图像来查询数据库，我们想看看谁发布了符合这一点的东西。出于各种原因，这当然很重要。负责产品营销、购买和定价的人员。社交媒体在很多情况下都很重要。

我们在其他领域也这样做。社交媒体监控现在只是暂时的事情。社交媒体监控，说到时尚，也是现在的事情。例如，有些公司只做这些。

**Sabine:** 在 Oluwa Sim 的聊天中，我们有一个关于这个时尚项目的问题。如果你能告诉我们更多的信息，你能解释一下你使用视觉搜索来部署那个时尚项目的过程吗？

**库巴:**大致来说，有两个组成部分。现在相关的组件是索引部分。这是因为，当然，其中一部分是在挖掘和搜集数据，然后将数据输入到一些数据库中。每当一张新图片出现时，我们实际上会运行检测来检测图片上的某些服装类型，因为如果你在 Instagram 上想象一张时尚图片，它通常会有多个项目。很难建立一个对时尚有全球性理解的系统，而我们却没有。

当然，也有公司致力于为你推荐一套服装，或者这件衣服是否适合你，但这是一个不同的问题。在我们的例子中，我们有模型做检测和分割，首先是物品。这些物品可以是裤子、连衣裙、帽子、t 恤等等。到最后，服装的种类就没那么多了。如果你仔细想想，我认为它们是 18 个封面，非常多的服装。

然后这些是从图像中提取出来的。你可以把它想象成一幅图像被分割成 N 幅图像。然后你需要跟踪并保存那些分段的部分。您还需要存储那些单独项目的嵌入，因为您永远不知道最终将如何检索它们。也许您只是针对某个类型运行查询。

例如，如果有人想在所有这些图片中找到一件相似的衣服，那么您将选择我正在寻找衣服，并且您将只在这个索引中寻找嵌入。我们可以缩小范围，但也许不行。也许可以扩大搜索范围。本质上，如你所见，一旦你挖掘了一张图片，以后，它可能会变成比这张更多的数据。这是需要注意的事情。

当然，也有不同的策略。你可以把不同事物的嵌入结合起来，得到这个时尚小时的全球描述符。最后，这是一个创建数据湖的过程，但对于图像，您可以。你还不知道你将如何使用它。您希望轻松访问它，并且不希望重新计算，因为运行分割和检测模型实际上是管道中最昂贵的时刻之一。你先做一次，然后再考虑什么样的解决方案可行。

> **Stephen:** 还是关于时尚行业的使用案例，我认为 Andrea 在 YouTube 上提出了一个很棒的问题，从软件工程的角度来看，你是如何将你的图片从 Instagram 不同的图片抓取到视频训练集的，这个过程对你来说是什么样的？

**库巴:**对，这个问题问得好。这个项目已经做了很长时间了，我不确定这是否仍然有效，但我会直说，因为 Instagram，当然，不喜欢抓取和挖掘，他们会反击你，但通常最简单的方法就是使用一个池，怎么叫呢？它们被称为 HTTP 代理。你实质上是出租服务，通过世界上不同的地方代理你的请求。

从工程的角度来看，这实际上很容易，因为他们给你一个端点，你可以通过它重定向所有的流量，通常，有服务做得很好。你可以向这个特定的用户发出一个请求，他们会通过中国或其他国家的服务器重定向这个请求。他们会继续这样做，继续保持平衡，继续使用不同的服务器。

这种情况一直持续到 Instagram 的 API 完全关闭。我想这仍然有效，对吗？我的意思是，唯一不起作用的是，如果有私人帐户，你不登录就无法访问，那么，当然，它会工作，但如果你需要登录，那么你就有问题了。我们的直觉是，我们想要获取数据的账户是开放的，因为它们来自其他公司，来自有影响力的大公司，他们不想让自己的账户成为私有账户。

训练视觉搜索模型的最大挑战

## **斯蒂芬:**牛逼。我认为我们有一个来自社区的非常好的问题，这也是我一直在想的，来自 Mashhad。我希望我把你的名字念对了。不管怎样，这是个很好的问题。比如，你在为视觉搜索模型训练模型时遇到的最大挑战是什么？你有没有尝试用一些新的技术来对抗它们？就计算机、你使用的技术等等而言，你在寻找什么？

**库巴:**我明白你的问题了。

我不知道我是否能回答这个问题，因为这是一个非常非常宽泛的问题，但我认为最重要的是，像往常一样，就像几乎所有的计算机视觉和机器学习一样，数据，对吗？获取正确的数据通常是最大的挑战。如果你在收集数据，那当然是一个问题。

> 如果你没有，如果你已经有数据，那么以正确的方式标记数据，如果是半标记或者如果是通过标记人来标记，那么这是你真正认为需要思考很多很多的关键步骤。我的意思是，因为如果你做错了，代价会很高，这是我能给的最好的建议。因为以后的训练，取决于我们谈论的模型。

例如，三元组和这种类型的三元组、四元组或连体类型的网络相对难以训练，因为它们存在以正确的方式对三元组进行采样的问题。数据集中的类越多，问题就越严重，但它们是针对非常大的数据集的。这就是你必须使用的，如果你有相当大的数据集用于学习良好的嵌入，你可以从本质上选择的是用于面部检测，面部识别，面部识别的网络，所以 DeepFace，ArcFace，CosFace。

它们是像分类网络一样被训练的网络，但是在损失函数中，你实际上学习到的嵌入比使用常规交叉熵分类更大地分离它们。这些都非常有效，你可以看到，例如，通过检查最近比赛中的地标识别，例如，在 Kaggle 上，它们也在那里被使用，在这场比赛中数据集是巨大的。

这项用于面部识别的技术实际上基本上是一样的，基础也是一样的，当然，像往常一样，在 Kaggle 上，有很多诡计在上面进行，但基础是面部识别技术应用于地标匹配的问题。从外部来看，这似乎是一个完全不同的问题，但解决方案是相同的，并且非常非常有效。那些 ArcFace CosFace 网络，它们实际上相对容易训练，不像交叉熵分类那么容易，但是接近它。

为视觉搜索选择训练架构

## 斯蒂芬:我有两个后续问题，如果我错了，也许你可以纠正我，我在想，你如何选择，比如说，你如何决定你要训练的训练架构，因为我假设你要处理大量的数据集。因此，当您处理大型数据集时，您如何确定训练过程是什么样的呢？

**Kuba:** 我认为，就像这里一样，当谈到训练和这个问题时，特别是当我们谈论这个 ArcFace 或类似分类的网络时，最终，你有多少个标签，所以假设你的数据集中有一百万个 id 或人或地标。这意味着你的最后几层在网络中变得越来越大，如果它们不适合一个模型，你就无能为力，然后你在多个设备上分割模型，你仍然要继续训练它。

如果人们不得不在数百万个 id 上进行训练，我会说，这已经很重要了，但其他网络，如果你想学习，更多地采用这种三胞胎训练的度量学习方法，那么就没有限制。我的意思是，最大的限制将是批量大小，这不一定是疯狂的大，但你没有这么大的模型，这是我的方式。

可视化搜索的数据转换方法

## Stephen: 我们有几个来自社区的问题。我很想问一下，在这个领域，有没有比其他人用得更多的常见转换方法？

库巴:转变和什么？

斯蒂芬:根据你的数据论证过程等等。

库巴:我不认为这真的有什么作用。如今，你所看到的绝对是闪亮的，当谈到，例如，Kaggle，以我的经验来看，那些剪裁方法比以往任何时候都更受关注。它们也很新，所以本质上就像剪切图像的一部分，它们被使用得相当多，但除此之外，增强永远是你拥有的数据的情况。

例如，我使用的动物图片需要非常小心哪些没有意义，哪些转换有意义。如果你有大量的数据，那么你也知道你可以使用较少的增强。例如，对于这个地标，如果有人对正在发生的任何新事情感兴趣，我认为在视觉搜索和匹配方面，这些比赛真的是一个很好的学习资源，你可以看到在上次视觉地标匹配比赛中的增强非常小。他们使用非常基本和非常低的程度，扩增。

Stephen:Kuba，就在我们准备结束这个话题的时候，有没有我们应该寻找的矢量相似工具和解决方案的潮流，比如说景观？那研究角度是什么？目前那个领域的研究进展如何？

Kuba: 我的意思是，对于数据相似性，现在有很多解决方案，从一些付费开始，一些免费开源。他们都有一些报价，但其中一些是建立在现有的数据库之上。我想我会给任何一个刚开始做这个的人推荐的是，如果你没有达到你需要搜索的一些巨大规模的百万以上的向量，我认为那些使用你已经拥有的数据库的解决方案，最有可能，例如， [Postgres](https://web.archive.org/web/20230117113021/https://www.postgresql.org/) 。

Postgres 中肯定内置了一个引擎，当然，它们不是官方的，但它们就像是使用一些数据库作为持久层的服务。如果它们符合您在堆栈中已有的内容，我会使用它们，对吗？因为将这些嵌入存储在其他数据所在的地方总是好的，因为这将为您提供更多的查询选项。

如果您的规模确实很大，并且您知道自己会回头，那么您可以购买托管服务并支付费用。然后你需要为每个指数付费。通常，对于每个索引和它在内存中占用的空间，因为大多数索引都是从 RAM 中运行的。您需要为大索引选择实例。

Stephen: 构建与购买的解决方案也是软件行业的一个话题。仅谈您的日常工作流程，您使用的基本工具堆栈是什么？你在构建一个可视化搜索引擎时使用的是什么技术？

我使用 Python 和 PyTorch，为了相似性，我想我现在尝试了大多数大的提供商，他们中的许多都很不错。从管理的解决方案来看，松果也是相当不错的选择。除此之外，对于日常工作，Python、PyTorch 和 [Fast API](https://web.archive.org/web/20230117113021/https://fastapi.tiangolo.com/) 帮助我构建了我目前正在构建的大部分东西。

扩展视觉搜索系统

## Stephen: 我认为另一个经常讨论的问题是，思考如何构建可以扩展到我们正在解决的任何问题的东西。从建立一个基线系统的方法，发展到能看到很多用户的方法，比如说，可能不是谷歌的规模，雅虎的规模，必应的规模，或者类似的方法，而是对用户有用的方法。如何从仅仅构建概念证明过渡到可扩展的东西？

Kuba: 我认为概念证明是，我会说，让我们假设概念证明可以是一个简单的东西，你把你的笔记本，你的嵌入索引实际上是在 NumPy 的内存中，你只需要用一个查询做一个点积，就这样。这可能是你非常非常基本的情况。然后，无论何时你移动，你都需要考虑诸如你将如何开始在模型本身上工作之类的事情，你需要继续考虑持久化和更新嵌入。

每当你发布一个新的模型，你需要慢慢地工作，最终，你拥有的管道，当然，如果你达到一个非常大的规模，那么你需要考虑这个问题的所有可扩展性问题。但是有解决方案可以帮助你。无论管理与否。例如，有一些矢量搜索引擎，你可以把它们部署成一个导航图，你已经准备好了。你有自己的服务可以集成，这当然是一种方式。

但我认为规模、查询大小或其他数据集可能更重要，因为它们将决定您需要重新计算所有内容的次数和频率，这很好。

其他问题

## **Sabine:** 在聊天中，Lev 问了我们一个问题，如果你熟悉的话，谁想知道 Kuba 觉得 Beams 视觉搜索与 Google Lens 匹配如何？

**库巴:**这个问题问得好。我真的不知道。我认为梁已经在这里一段时间了，但是的，谷歌一肯定，这是非常好的。这真的很神奇，因为最近，我想在一家我非常喜欢的酒店里找一把椅子，在世界上所有的椅子中，我第一次就找到了，我觉得这太令人印象深刻了。

是的，我们这里有一些用户在聊天中寻求建议。我们有 Chimobe 询问关于建立一个在线市场平台的图像验证系统。

我会试着找出这可能是什么问题。我在市场上看到的一个问题是，比如说，你在易贝或其他地方可能会遇到的问题是，类别的数量不是恒定的。这是一个有效的问题，因为如果它不是常数，这意味着你不能只使用简单的分类，因为否则，我会说，“好吧，我在卖一个被分类为板的板，”然后它在一些 UI 中有所帮助。

对于一个新的类别，你不会马上支持它。如果您使用任何度量学习或相似性方法，您可以做的是您将只需要一个新类别的实例。如果有人问什么，她没有找到类别，但她把它放在价值类别或一些精彩的经理，网站做到了。然后，我们有一个与新类别相关联的图像。

这就是一次性学习的典型问题。然后我们可以通过良好的嵌入来做到这一点。我们要做的不是把它作为一个分类问题，而是在未来，我们会把一张新图片和所有类别的图片进行比较，选择最接近的一张。那么你就解决了类别数量变化的问题。这是我在市场上看到的问题，但也许这个人可以详细说明这是什么意思。

**Sabine:** 是的，我们有和我们一起通话的人。

好吧，我问的是你有，就像亚马逊一样，人们上传他们产品的图片，他们在网上卖什么。现在有些人可能会犯错误，或者他们可能想上传一台笔记本电脑，然后他们将这台笔记本电脑命名为一个人，这是一种误导。现在，我们如何验证这些上传，知道有 N 个产品，但我们不知道这个人在特定时间可能上传的特定产品是什么？这是不是意味着我们必须不断下载产品类别才能得到这样的结果？

**库巴:**好的，我理解问题是说一个用户选择了一个类别出错，然后图片没有在反映这个类别。是这种情况吗？

**Chimobean:** 对，对。现在，产品类别正在为此使用机器学习模型，这意味着我们必须下载各种图像来进行验证，以训练我们的模型。

**Kuba:** 我正在想办法弄清楚我是否得到了问题。在这种情况下，你说的下载是什么意思？我的意思是，因为在我看来，这要么是一个分类问题，要么是比较问题，所以是相似性问题。如果您已经为该任务训练了模型，那么您可以根据类别来验证输入。我不确定我是否理解了这个问题。或许有人对此有看法？也许有人对此有不同的理解。

**Sabine:** 这可能是一个如何着手建立数据集的问题，你需要首先训练模型并验证它们？

**Chimobean:** 是的。我们要从不同的类别中获取数据吗？明天，有人可能会出现并上传一个可能不在我们数据中的类别，一个我们的模型没有训练过的特定产品。这就是我要问的。我们现在如何验证这一点？

库巴:我想这是我之前说过的，现在仍然有效。最后，对于固定数量的类，您可以对不固定的类进行分类。在你的情况下，本质上是类别，然后你会本质上找出这个新图像的嵌入，你会看到它不太适合任何类别，或者距离会很远，然后你可能会打电话，“嘿，也许这个类别和这个图像之间没有匹配。”我认为，这将是一个有效的方法。

把它包起来！

## 斯蒂芬:当然，我想我们的时间不多了，但这真的是一次很好的谈话。我认为你可以继续留在 [MLOps 社区](https://web.archive.org/web/20230117113021/https://mlops.community/)。听众和观众们，如果你们还没有加入 MLOps 社区，你们可以[在这里](https://web.archive.org/web/20230117113021/https://go.mlops.community/slack)加入。

萨宾:是的，我们今天就要结束了。如果你的问题没有得到回答，也不用担心。你可以在计算机视觉频道或 neptune.ai 频道随时联系我们。非常感谢每一个提问的人，也非常感谢库巴加入我们，回答我们所有燃烧的视觉搜索问题。我们将在两周后带着我们的下一集 *MLOps Live* 回来。两周内，我们将邀请[雅格布·塔利亚布埃来讨论所有合理规模的事情。](/web/20230117113021/https://neptune.ai/blog/mlops-reasonable-scale-jacopo-tagliabue)

**Sabine:** Yes, we’ll be wrapping up here today. No worries if you didn’t get your question answered. You can always reach out to us on slack in the Computer Vision channel or in the neptune.ai channel. Thank you very much to everyone who asked questions, and thank you very much, Kuba, for joining us and answering all our burning visual search questions. We will return in two weeks with our next episode of *MLOps Live*. We will be having [Jacopo Tagliabue on to discuss all things reasonable scale MLOps](/web/20230117113021/https://neptune.ai/blog/mlops-reasonable-scale-jacopo-tagliabue), in two weeks.