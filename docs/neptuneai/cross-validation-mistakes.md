# 7 ä¸ªäº¤å‰éªŒè¯é”™è¯¯ä¼šè®©ä½ æŸå¤±æƒ¨é‡[ML ä¸­çš„æœ€ä½³å®žè·µ]

> åŽŸæ–‡ï¼š<https://web.archive.org/web/https://neptune.ai/blog/cross-validation-mistakes>

æˆ‘ä»¬éƒ½å¸Œæœ›æˆ‘ä»¬çš„æ¨¡åž‹èƒ½å¤Ÿå¾ˆå¥½åœ°æ³›åŒ–ï¼Œä»¥ä¾¿å®ƒä»¬åœ¨ä»»ä½•ç±»åž‹çš„æ•°æ®é›†ä¸Šéƒ½ä¿æŒæœ€ä½³æ€§èƒ½ã€‚ä¸ºäº†ç¡®ä¿è¿™æ ·çš„éœ€æ±‚ï¼Œæˆ‘ä»¬ç»å¸¸åœ¨æœºå™¨å­¦ä¹ é¡¹ç›®ä¸­ä¾èµ–äº¤å‰éªŒè¯ï¼Œè¿™æ˜¯ä¸€ç§ç”¨äºŽè¯„ä¼°æœ‰é™æ•°æ®æ ·æœ¬ä¸Šçš„æœºå™¨å­¦ä¹ æ¨¡åž‹çš„é‡é‡‡æ ·ç¨‹åºã€‚å½“ä½ èŠ±äº†è¿™ä¹ˆå¤šæ—¶é—´æ¥è°ƒæ•´ä½ çš„æ¨¡åž‹ï¼Œå´å‘çŽ°ä½ çš„äº¤å‰éªŒè¯ç­–ç•¥æœ‰é—®é¢˜ï¼Œè¿™å¯èƒ½æ˜¯ä¸€åœºå™©æ¢¦ã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºäººä»¬åœ¨ä½¿ç”¨äº¤å‰éªŒè¯æ—¶æœ€å¸¸çŠ¯çš„ä¸ƒä¸ªé”™è¯¯ï¼Œä»¥åŠå¦‚ä½•é¿å…å®ƒä»¬ã€‚è®©æˆ‘ä»¬ä»Žäº¤å‰éªŒè¯çš„ç®€å•ä»‹ç»å¼€å§‹ã€‚

## ä»€ä¹ˆæ˜¯äº¤å‰éªŒè¯ï¼Ÿ

å®ƒæ˜¯ä¸€ç§ç»Ÿè®¡æ–¹æ³•ï¼Œç”¨äºŽåœ¨æœºå™¨å­¦ä¹ æ¨¡åž‹æŠ•å…¥ä½¿ç”¨ä¹‹å‰è¯„ä¼°å…¶æ€§èƒ½ã€‚å®ƒåŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤:

1.  é¦–å…ˆï¼Œæˆ‘ä»¬å°†æ•°æ®é›†åˆ†æˆ k ä¸ªæŠ˜å ã€‚
2.  k ä¸ªæŠ˜å ä¸­çš„ä¸€ä¸ªç”¨äºŽæµ‹è¯•ï¼Œè€Œ k-1 ä¸ªæŠ˜å ç”¨äºŽæ¨¡åž‹è®­ç»ƒã€‚
3.  è¿™ä¸ªè¿‡ç¨‹é‡å¤ k æ¬¡ï¼Œä»¥ä¼°è®¡æ¨¡åž‹çš„å¹³å‡æ€§èƒ½ã€‚

![Cross-validation-k-fold](img/21a57295a9ef23302c43d5ab4f7b7969.png)

*K-fold cross-validation | [Source](/web/20220928202143/https://neptune.ai/blog/cross-validation-in-machine-learning-how-to-do-it-right)*

è¿™ç§æ–¹æ³•äº§ç”Ÿçš„æ€§èƒ½è¯„ä¼°åå·®è¾ƒå°ã€‚

### äº†è§£æ›´å¤šä¿¡æ¯

è¦äº†è§£æ›´å¤šå…³äºŽäº¤å‰éªŒè¯çš„ä¿¡æ¯ï¼Œä½ å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ðŸ‘‰[æœºå™¨å­¦ä¹ ä¸­çš„äº¤å‰éªŒè¯:å¦‚ä½•æ­£ç¡®æ“ä½œ](/web/20220928202143/https://neptune.ai/blog/cross-validation-in-machine-learning-how-to-do-it-right)

## è¿›è¡Œäº¤å‰éªŒè¯æ—¶çš„å¸¸è§é”™è¯¯

### 1.éšæœºé€‰æ‹©åˆ†è£‚çš„æ•°é‡

k-fold äº¤å‰éªŒè¯çš„å…³é”®é…ç½®å‚æ•°æ˜¯ kï¼Œå®ƒå®šä¹‰äº†æ•°æ®é›†å°†è¢«åˆ†å‰²çš„æŠ˜å æ•°ã€‚è¿™æ˜¯ä½¿ç”¨ k æŠ˜å äº¤å‰éªŒè¯æ—¶çš„ç¬¬ä¸€ä¸ªå›°å¢ƒã€‚æˆ‘ä»¬é€šå¸¸åšæŒæœ€å¸¸ç”¨çš„ k å€¼ï¼Œå³ 5ï¼Œè¿™åœ¨è®¡ç®—ä¸Šä¸å¤ªæ˜‚è´µã€‚

æ²¡æœ‰ç¡¬æ€§çš„è§„åˆ™æ¥å†³å®š k çš„å€¼ã€‚å¦‚æžœ k çš„å€¼å¤ªå°(å¦‚ 2 æˆ– 3)ï¼Œæ€§èƒ½ä¼°è®¡å™¨çš„æ‚²è§‚åå·®ä¼šå¾ˆé«˜ã€‚å¦‚æžœæ‚¨å¢žåŠ  k çš„å€¼ï¼Œåˆ™æ‰€å¾—ä¼°è®¡å€¼çš„åå·®å’Œæ–¹å·®å°†ä¼šå‡å°‘ï¼Œä»Žè€Œåœ¨ k=10 é™„è¿‘ç»™å‡ºä¸€ä¸ªåˆé€‚çš„æŠ˜è¡·ã€‚

ä½†æ˜¯ï¼Œåœ¨ç¡®å®š k çš„å€¼æ—¶ï¼Œå¿…é¡»ç¡®ä¿æ‰€é€‰çš„å€¼å¯¹æ•°æ®é›†æœ‰æ„ä¹‰ã€‚è§£å†³è¿™ä¸€é—®é¢˜çš„ä¸€ç§ç»è¿‡è¯•éªŒå’Œæµ‹è¯•çš„æ–¹æ³•æ˜¯å¯¹ä¸åŒçš„ k å€¼è¿›è¡Œæ•æ„Ÿæ€§åˆ†æžï¼Œå³è¯„ä¼°å…·æœ‰ä¸åŒ k å€¼çš„æ¨¡åž‹çš„æ€§èƒ½ï¼Œå¹¶è§‚å¯Ÿå®ƒä»¬çš„è¡¨çŽ°ã€‚

## 2.æ€»æ˜¯é€‰æ‹©ç›®æ ‡åˆ†å±‚äº¤å‰éªŒè¯è¿›è¡Œåˆ†ç±»

åœ¨å¤„ç†åˆ†ç±»é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬çš„è‡ªç„¶å€¾å‘æ˜¯æ€»æ˜¯é€‰æ‹©åœ¨ç›®æ ‡æ ‡ç­¾ä¸Šåˆ†å±‚çš„æµè¡Œçš„**åˆ†å±‚ k æŠ˜å **ã€‚è¿™é‡Œå‡è®¾åº•å±‚æ•°æ®åŒ…å«**ç‹¬ç«‹æ ·æœ¬ï¼Œå¹¶ä¸”æ˜¯åŒåˆ†å¸ƒçš„ã€‚**ç„¶è€Œï¼Œè¿™å¹¶ä¸ä¸€å®šé€‚ç”¨äºŽæ‰€æœ‰æƒ…å†µã€‚è®©æˆ‘ä»¬å€ŸåŠ©ä¸€ä¸ªä¾‹å­æ¥ç†è§£è¿™ä¸€ç‚¹:

è€ƒè™‘ä»Žå¤šä¸ªæ‚£è€…æ”¶é›†çš„åŒ»ç–—æ•°æ®ï¼Œè¯¥æ•°æ®å¯èƒ½åŒ…å«æ¥è‡ªæ¯ä¸ªæ‚£è€…çš„å¤šä¸ªæ ·æœ¬ã€‚å¹¶ä¸”è¿™ç§æ•°æ®å¯èƒ½ä¾èµ–äºŽä¸ªä½“æ‚£è€…ç»„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æƒ³çŸ¥é“æˆ‘ä»¬åœ¨ç‰¹å®šç¾¤ä½“ä¸Šè®­ç»ƒçš„æ¨¡åž‹æ˜¯å¦èƒ½åœ¨çœ‹ä¸è§çš„æ‚£è€…ç¾¤ä½“ä¸Šå¾ˆå¥½åœ°æŽ¨å¹¿ã€‚ä¸ºäº†å®žçŽ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¸Œæœ›ä¿æŒè®­ç»ƒç»„å’ŒéªŒè¯ç»„ç›¸äº’æŽ’æ–¥ï¼Œå³ä¸åœ¨éªŒè¯æ•°æ®é›†ä¸­ä¿ç•™ä»»ä½•è®­ç»ƒæ‚£è€…ç»„ã€‚

**ç»„ k å€**æ˜¯å¸®åŠ©æˆ‘ä»¬å¤„ç†ä¸Šè¿°æƒ…å†µçš„ k å€çš„å˜å¼‚ã€‚å®ƒç¡®ä¿åŒä¸€ç»„ä¸ä¼šå‡ºçŽ°åœ¨è®­ç»ƒé›†ã€éªŒè¯é›†å’Œæµ‹è¯•é›†ä¸­ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ° scikit-learn å®žçŽ°ã€‚

![Group k-fold](img/379f3f4d31edab119a1ffd9048e0c830.png)

*GroupKfold cross validation | [Source](https://web.archive.org/web/20220928202143/https://scikit-learn.org/stable/auto_examples/model_selection/plot_cv_indices.html)*

å¤§éƒ¨åˆ†åˆ†ç±»é—®é¢˜éƒ½æœ‰ç±»åˆ«[ä¸å¹³è¡¡æ•°æ®](/web/20220928202143/https://neptune.ai/blog/how-to-deal-with-imbalanced-classification-and-regression-data)ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨å¯èƒ½å¸Œæœ›å°† k ç»„æŠ˜å ä¸Žåˆ†å±‚ç›¸ç»“åˆï¼Œè¿™é‡Œæœ‰ä¸€ä¸ª scikit-learn dev å®žçŽ°**åˆ†å±‚ k ç»„æŠ˜å **ï¼Œæ‚¨å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ã€‚

![Stratified group k fold](img/d41a0e674e3b24810a5bc3b326f4ca86.png)

*Stratified GroupKfold cross validation | [Source](https://web.archive.org/web/20220928202143/https://scikit-learn.org/stable/auto_examples/model_selection/plot_cv_indices.html)*

åœ¨ä¸Šå›¾ä¸­ï¼Œæ‚¨å¯ä»¥çœ‹åˆ° GroupKfold å’Œ StatifiedGroupKfold ä¹‹é—´çš„åŒºåˆ«ã€‚åˆ†å±‚ç»„ k-fold åœ¨å°è¯•è¿”å›žåˆ†å±‚æ ·æœ¬æ—¶è¯•å›¾ä¿æŒå¯¹ç»„ k-fold çš„çº¦æŸã€‚

### 3.å›žå½’é—®é¢˜ä¸­äº¤å‰éªŒè¯æŠ€æœ¯çš„é€‰æ‹©

ä¸ºå›žå½’é—®é¢˜é€‰æ‹©äº¤å‰éªŒè¯æ–¹æ¡ˆæ—¶ï¼Œå¤§å¤šæ•°äººä¼šé€‰æ‹©æ­£æ€ K å€ï¼Œå› ä¸ºç›®æ ‡å€¼æ˜¯è¿žç»­çš„ã€‚è¿™å°†å¯¼è‡´è®­ç»ƒå’ŒéªŒè¯é›†éšæœºåˆ†è£‚ï¼Œä¸”ä¸èƒ½ç¡®ä¿è®­ç»ƒå’ŒéªŒè¯ä¸­ç›®æ ‡å€¼çš„ç›¸åŒåˆ†å¸ƒã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªå¸¸è§çš„é”™è¯¯ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç›®æ ‡å€¼åˆ†æˆ n ä¸ªç®±ï¼Œç„¶åŽä½¿ç”¨è¿™äº›ç®±å€¼è¿›è¡Œåˆ†å±‚ k æŠ˜å ã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹è¿™æ˜¯å¦‚ä½•åšåˆ°çš„:

```py
From sklearn.model_selection import StratifiedKFold
def create_folds(df, n_grp, n_s=5):

    df['Fold'] = -1
    skf = StratifiedKFold(n_splits=n_s)
    df['grp'] = pd.cut(df.target, n_grp, labels=False)
    target = df.grp
    for fold_no, (t, v) in enumerate(skf.split(target, target)):
        df.loc[v, 'Fold'] = fold_no
    return df
```

çŽ°åœ¨ï¼Œè¿™å°†ç¡®ä¿åœ¨æ‚¨è®­ç»ƒå’ŒéªŒè¯ä¸­æœ‰ä¸€ä¸ªç›¸åŒçš„ç›®æ ‡åˆ†å¸ƒã€‚è¿™ç§æ–¹æ³•ä¹Ÿç§°ä¸ºè¿žç»­ç›®æ ‡åˆ†å±‚ã€‚

### 4.äº¤å‰éªŒè¯å‰çš„è¿‡é‡‡æ ·

è¿™æ˜¯æˆ‘åœ¨å¤„ç†åˆ†ç±»é—®é¢˜æ—¶è¿›è¡Œäº¤å‰éªŒè¯æ—¶è§‚å¯Ÿåˆ°çš„ä¸€ä¸ªéžå¸¸å¸¸è§çš„é”™è¯¯ã€‚åˆ†ç±»ä»»åŠ¡ä¸­çš„å¤§å¤šæ•°æ•°æ®é›†éƒ½å­˜åœ¨ç±»ä¸å¹³è¡¡é—®é¢˜ã€‚è§£å†³**ç±»ä¸å¹³è¡¡**çš„ä¸€ç§æ–¹æ³•æ˜¯è¿›è¡Œè¿‡é‡‡æ ·ï¼Œå³é€šè¿‡éšæœºå°†å°‘æ•°ç±»çš„æ ·æœ¬æ·»åŠ åˆ°æ•°æ®é›†ä¸­ï¼Œä»¥ä½¿æ¯ä¸ªæ ‡ç­¾çš„æ ·æœ¬æ•°é‡å¹³è¡¡ã€‚

å‡è®¾æ‚¨æ­£åœ¨å¤„ç†ä¸€ä¸ªæ¬ºè¯ˆæ£€æµ‹æ•°æ®é›†ã€‚ä½ å‘çŽ°åœ¨è¿™ä¸ªé—®é¢˜ä¸Šå­˜åœ¨æžç«¯çš„é˜¶çº§ä¸å¹³è¡¡ï¼Œä½ å†³å®šé¦–å…ˆè§£å†³è¿™ä¸ªé—®é¢˜ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½ å†³å®šè¿›è¡Œè¿‡é‡‡æ ·ã€‚åœ¨è¿™ä¹‹åŽï¼Œä½ é€‰æ‹©åšäº¤å‰éªŒè¯ã€‚çŽ°åœ¨ï¼Œé€šè¿‡ k-fold äº¤å‰éªŒè¯å½¢æˆçš„è®­ç»ƒå’ŒéªŒè¯æ•°æ®é›†å°†å…·æœ‰è®¸å¤šå…¬å…±æ ·æœ¬ï¼Œè¿™å°†å¯¼è‡´**é«˜ä¼°æ¨¡åž‹æ€§èƒ½**ã€‚å› æ­¤ï¼Œ**é¿å…åœ¨äº¤å‰éªŒè¯ä¹‹å‰è¿›è¡Œè¿‡é‡‡æ ·ã€‚**

å¦‚æžœè¿‡é‡‡æ ·å¯¹æ‚¨çš„ä»»åŠ¡è‡³å…³é‡è¦ï¼Œæ‚¨åº”è¯¥é¦–å…ˆå°†æ•°æ®æ‹†åˆ†åˆ°ç›¸åº”çš„æŠ˜å ä¸­ï¼Œç„¶åŽåœ¨è®­ç»ƒå’ŒéªŒè¯å¾ªçŽ¯ä¸­ç»§ç»­è¿›è¡Œä¸Šé‡‡æ ·ã€‚ä¸‹é¢æ˜¯å®žçŽ°è¿™ä¸€ç‚¹çš„ä¼ªä»£ç :

```py
kfold = KFold(n_splits=n_splits)
scores = []
for train,valid in kfold.split(data):

        train_oversampled = oversample_function(train) 
        score = train_and_validate(train_oversampled,valid) 
        scores.append(score)
```

### 5.çŸ¥è¯†æ³„éœ²

è¿™æ˜¯æœºå™¨å­¦ä¹ ä¸­çš„ä¸€ä¸ªä¸»è¦é—®é¢˜ï¼Œåœ¨è¿›è¡Œäº¤å‰éªŒè¯æ—¶ä¹Ÿå¾ˆå¸¸è§ã€‚çŸ¥è¯†æ³„æ¼æˆ–æ•°æ®æ³„æ¼æ˜¯æŒ‡ä½¿ç”¨è®­ç»ƒé›†ä¹‹å¤–çš„**ä¿¡æ¯æ¥åˆ›å»ºæ¨¡åž‹ã€‚è¿™äº›é¢å¤–çš„ä¿¡æ¯å…è®¸æ¨¡åž‹çŸ¥é“ä¸€äº›å®ƒåŽŸæœ¬ä¸çŸ¥é“çš„å…³äºŽæ•°æ®çš„é¢å¤–ä¿¡æ¯ã€‚è¿™å¯¼è‡´**è¿‡äºŽä¹è§‚çš„é¢„æµ‹**å’Œ**é«˜ä¼°è½¦åž‹æ€§èƒ½**ã€‚è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªæµè¡Œçš„é”™è¯¯æ¥ç†è§£è¿™ä¸€ç‚¹ï¼Œ**

å‡è®¾æ‚¨æ­£åœ¨å¤„ç†åŒ…å«æ•°ç™¾ä¸ªç‰¹å¾çš„è¯ç‰©åˆ†ç±»è¡¨æ ¼æ•°æ®ã€‚ä½ å†³å®šé€šè¿‡ä¸»æˆåˆ†åˆ†æžè¿›è¡Œä¸€äº›ç‰¹å¾å·¥ç¨‹ã€‚å®Œæˆ PCA åŽï¼Œå°†å‰ 5 ä¸ªä¸»æˆåˆ†ä½œä¸ºç‰¹å¾æ·»åŠ åˆ°æ•°æ®ä¸­ã€‚ä¹‹åŽï¼Œæ‚¨å†³å®šè¿›è¡Œäº¤å‰éªŒè¯ï¼Œå¹¶å°†æ•°æ®è¾“å…¥ CV å¾ªçŽ¯ã€‚çŽ°åœ¨ä½ ä¼šå‘çŽ°ä½ çš„ç®€åŽ†æˆç»©æ¯”é¢„æœŸæé«˜äº†å¾ˆå¤šã€‚æ‚¨å¯¹æ‚¨çš„æ¨¡åž‹æ„Ÿåˆ°æ»¡æ„ï¼Œå¹¶ç»§ç»­åœ¨ç»´æŒæµ‹è¯•é›†ä¸Šæµ‹è¯•æ€§èƒ½ã€‚ä½†æ˜¯å‡ºä¹Žä½ çš„æ„æ–™ï¼Œä½ çš„æ¨¡åž‹è¡¨çŽ°å¾ˆå·®ï¼

è¿™é‡Œï¼Œæ‚¨çŠ¯äº†æ•°æ®æ³„æ¼çš„é”™è¯¯ï¼Œå› ä¸ºæ‚¨å¯¹æ•´ä¸ªæ•°æ®è¿›è¡Œäº† PCAï¼Œè€Œä¸æ˜¯åˆ†åˆ«å¯¹è®­ç»ƒå’ŒéªŒè¯è¿›è¡Œ PCAã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä»»ä½•åº”ç”¨äºŽæ•°æ®çš„**ç‰¹å¾å·¥ç¨‹éƒ½åº”è¯¥åœ¨ CV å¾ªçŽ¯**å†…å•ç‹¬è¿›è¡Œè®­ç»ƒå’ŒéªŒè¯ï¼Œä»¥é¿å…æ•°æ®æ³„æ¼ã€‚

### 6.æ—¶é—´åºåˆ—æ•°æ®çš„äº¤å‰éªŒè¯

æˆ‘ä»¬çŸ¥é“æ—¶é—´åºåˆ—æ•°æ®æ˜¯ä¸åŒçš„ã€‚åœ¨è¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹æ—¶ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯å»ºç«‹ä¸€ä¸ªèƒ½å¤Ÿæ ¹æ®è¿‡åŽ»çš„ä¸€äº›è§‚å¯Ÿç»“æžœé¢„æµ‹æœªæ¥çš„æ¨¡åž‹ã€‚åœ¨éªŒè¯æ—¶é—´åºåˆ—æ¨¡åž‹æ—¶ï¼Œåº”è¯¥å§‹ç»ˆåªä¿ç•™éªŒè¯/æµ‹è¯•é›†ä¸­è¿‡æœŸçš„æ ·æœ¬ã€‚è¿™æ˜¯ä¸ºäº†ç¡®ä¿æ¨¡åž‹èƒ½å¤Ÿå¾ˆå¥½åœ°æ¦‚æ‹¬åŽ†å²æ•°æ®ã€‚

åœ¨å¯¹æ—¶é—´åºåˆ—æ•°æ®å»ºæ¨¡æ—¶ï¼Œä½¿ç”¨ scikit-learn ä¸­å¯ç”¨çš„æ™®é€š k-fold æ–¹æ³•è¿›è¡Œäº¤å‰éªŒè¯æ˜¯ä¸€ä¸ªå¸¸è§çš„é”™è¯¯ã€‚è¿™å°†å¯¼è‡´è®­ç»ƒå’ŒéªŒè¯æ•°æ®é›†çš„éšæœºåˆ†å‰²ï¼Œæ— æ³•ç¡®ä¿**è¶…æ—¶æ¡ä»¶**ã€‚å› æ­¤ï¼Œåœ¨è¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹æ—¶ï¼Œåº”è¯¥å§‹ç»ˆä½¿ç”¨ scikit-learn ä¸­å¯ç”¨çš„ [**æ—¶é—´åºåˆ—åˆ†å‰²**](https://web.archive.org/web/20220928202143/https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.TimeSeriesSplit.html) **æ–¹æ³•**æ¥è¿›è¡Œäº¤å‰éªŒè¯ã€‚

![Cross validation for time series](img/b56561156f32045e42e4f3db2dd56dd6.png)

*Time series split cross validation | [Source](https://web.archive.org/web/20220928202143/https://goldinlocks.github.io/Time-Series-Cross-Validation/#:~:text=Blocked%20cross%2Dvalidation%20works%20by,and%20another%20as%20a%20response.)*

æ»žåŽç‰¹å¾è¢«å¹¿æ³›ç”¨äºŽæ—¶é—´åºåˆ—é¢„æµ‹æ—¶çš„å“åº”å»ºæ¨¡ï¼Œè¿™ä¹Ÿå¯èƒ½å¯¼è‡´æ•°æ®æ³„æ¼ã€‚ä½¿ç”¨æ»žåŽåŠŸèƒ½æ—¶ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨[é˜»å¡žæ—¶é—´åºåˆ—åˆ†å‰²](https://web.archive.org/web/20220928202143/https://goldinlocks.github.io/Time-Series-Cross-Validation/#:~:text=Blocked%20cross%2Dvalidation%20works%20by,and%20another%20as%20a%20response.)ã€‚ä¸‹å›¾æè¿°äº†æ—¶é—´åºåˆ—åˆ†å‰²å’Œåˆ†å—æ—¶é—´åºåˆ—åˆ†å‰²æ–¹æ³•ä¹‹é—´çš„åŒºåˆ«ã€‚

![Cross validation for time series](img/3f57171b82098d143080307ea5162534.png)

*Blocking time series split cross validation |* [*Source*](https://web.archive.org/web/20220928202143/https://goldinlocks.github.io/Time-Series-Cross-Validation/#:~:text=Blocked%20cross%2Dvalidation%20works%20by,and%20another%20as%20a%20response.)

å®ƒçš„å·¥ä½œåŽŸç†æ˜¯åœ¨ä¸¤ä¸ªä½ç½®å¢žåŠ è¾¹è·ã€‚ç¬¬ä¸€ä¸ªæ˜¯åœ¨è®­ç»ƒå’ŒéªŒè¯æŠ˜å ä¹‹é—´ï¼Œä»¥é˜²æ­¢æ¨¡åž‹è§‚å¯Ÿåˆ°ä¸¤æ¬¡ä½¿ç”¨çš„æ»žåŽå€¼ï¼Œä¸€æ¬¡ä½œä¸ºå›žå½’å˜é‡ï¼Œå¦ä¸€æ¬¡ä½œä¸ºå“åº”ã€‚ç¬¬äºŒä¸ªæ˜¯åœ¨æ¯æ¬¡è¿­ä»£ä¸­ä½¿ç”¨çš„æŠ˜å ä¹‹é—´ï¼Œä»¥é˜²æ­¢æ¨¡åž‹ä»Žä¸€æ¬¡è¿­ä»£åˆ°ä¸‹ä¸€æ¬¡è¿­ä»£è®°ä½æ¨¡å¼ã€‚

### 7.äº¤å‰éªŒè¯ä¼°è®¡ä¸­çš„éšæœºæ€§

å‡ ä¹Žæ‰€æœ‰ç”¨äºŽæœºå™¨å­¦ä¹ çš„ç®—æ³•éƒ½å—åˆ°éšæœºç§å­å€¼çš„å½±å“ã€‚ç„¶è€Œï¼Œåœ¨åƒå˜åŽ‹å™¨è¿™æ ·çš„å¤æ‚æ·±åº¦ç¥žç»ç½‘ç»œçš„æƒ…å†µä¸‹ï¼Œéšæœºç§å­çš„æ•ˆæžœç‰¹åˆ«é«˜ã€‚å½“ç”¨å°æ•°æ®é›†è®­ç»ƒåƒ BERT è¿™æ ·çš„å¤§æ¨¡åž‹æ—¶ï¼Œè¿™ç§æ•ˆæžœä¼šéžå¸¸æ˜Žæ˜¾ã€‚å¯¹äºŽè¿™æ ·çš„æ¨¡åž‹ï¼Œæ‚¨ä¸å¤ªå¯èƒ½ä½¿ç”¨æ­£å¸¸çš„äº¤å‰éªŒè¯æ¥èŽ·å¾—æ¨¡åž‹æ€§èƒ½çš„å‡†ç¡®ä¼°è®¡ã€‚

ä¸ºäº†é¿å…åœ¨ç”¨ä½ åšæŒçš„æµ‹è¯•æ•°æ®é›†æµ‹è¯•ä½ çš„æ¨¡åž‹æ—¶å‡ºçŽ°ä»»ä½•æ„å¤–ï¼Œä½ åº”è¯¥åœ¨å¤šä¸ªç§å­ä¸Šåš**äº¤å‰éªŒè¯ï¼Œå¹¶å¹³å‡æ¨¡åž‹æ€§èƒ½**ã€‚è¿™å°†ä½¿æ‚¨èƒ½å¤Ÿæ›´å¥½åœ°ç†è§£æ‚¨çš„æ¨¡åž‹æ€§èƒ½ã€‚è¿™æ˜¯å®ƒçš„ä¼ªä»£ç ï¼Œ

```py
SEEDS = [1, 2, 3, 4, 5]
ScoreMetric = []

for seed in SEEDS:

    seed_all(seed) 
    kfold = KFold(n_splits=5, random_state=seed)
    scores = []

    for train,valid in kfold.split(data):

            score = train_and_validate(train,valid) 
            scores.append(score)

    ScoreMetric.append(scores)

Print(f"Average Model Performance {np.mean(ScoreMetric)}")
```

## ç»“è®º

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†äººä»¬åœ¨è¿›è¡Œäº¤å‰éªŒè¯æ—¶ä¼šçŠ¯çš„ä¸€äº›å¸¸è§é”™è¯¯ã€‚æˆ‘ä»¬è¿˜ç ”ç©¶äº†è¿™äº›é”™è¯¯çš„ä¸åŒè§£å†³æ–¹æ¡ˆã€‚æˆ‘å¸Œæœ›é€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œä½ èƒ½å¤Ÿæ›´å¥½åœ°äº†è§£äº¤å‰éªŒè¯ã€‚

åŒæ—¶ï¼Œæˆ‘ä¼šæ•¦ä¿ƒä½ å‚è€ƒæ›´å¤šå…³äºŽä½¿ç”¨ä¸åŒæ¨¡åž‹é€‰æ‹©å’ŒéªŒè¯æŠ€æœ¯çš„å®žéªŒçš„ç ”ç©¶è®ºæ–‡ã€‚æˆ‘é™„ä¸Šäº†ä¸€äº›å¾ˆå¥½çš„å‚è€ƒèµ„æ–™ï¼Œä»¥å¸®åŠ©æ‚¨å¼€å§‹å­¦ä¹ ã€‚

### å‚è€ƒ

### æ²™èƒ¡å°” ES

æ•°æ®ç§‘å­¦å®¶ï¼Œéžå¸¸ç†Ÿæ‚‰æœºå™¨å­¦ä¹ ã€NLP å’ŒéŸ³é¢‘å¤„ç†é¢†åŸŸã€‚ä»–æ˜¯ Kaggle å¤§å¸ˆï¼Œä¹Ÿå–œæ¬¢åšå¼€æºã€‚

* * *

**é˜…è¯»ä¸‹ä¸€ç¯‡**

## å¦‚ä½•æ¯”è¾ƒæœºå™¨å­¦ä¹ æ¨¡åž‹å’Œç®—æ³•

9 åˆ†é’Ÿé˜…è¯»|ä½œè€… Samadrita Ghosh |å¹´ 9 æœˆ 16 æ—¥æ›´æ–°

æœºå™¨å­¦ä¹ åœ¨è¿‡åŽ»å‡ å¹´é‡Œè¿…é€Ÿå‘å±•ã€‚ä»Šå¤©ï¼Œæ•°æ®ç§‘å­¦å®¶å’Œå¼€å‘äººå‘˜ä¸å†ä½¿ç”¨ç®€å•çš„ã€å•å‘çš„æˆ–çº¿æ€§çš„ ML ç®¡é“ï¼Œè€Œæ˜¯è¿è¡Œå¤šä¸ªå¹¶è¡Œå®žéªŒï¼Œå³ä½¿å¯¹äºŽå¤§åž‹å›¢é˜Ÿæ¥è¯´ï¼Œè¿™äº›å®žéªŒä¹Ÿå¯èƒ½å˜å¾—ä¸å ªé‡è´Ÿã€‚æ¯ä¸ªå®žéªŒéƒ½åº”è¯¥ä»¥ä¸€ç§ä¸å˜çš„ã€å¯é‡å¤çš„æ ¼å¼è®°å½•ä¸‹æ¥ï¼Œè¿™å°±äº§ç”Ÿäº†æ— ç©·æ— å°½çš„æ—¥å¿—ï¼Œå…¶ä¸­åŒ…å«äº†æ— ä»·çš„ç»†èŠ‚ã€‚

æˆ‘ä»¬éœ€è¦é€šè¿‡å°†æœºå™¨å­¦ä¹ æ¨¡åž‹ä¸Žå¹³è¡Œå®žéªŒè¿›è¡Œå½»åº•æ¯”è¾ƒæ¥ç¼©å°æŠ€æœ¯èŒƒå›´ã€‚ä½¿ç”¨è®¡åˆ’å‘¨å¯†çš„æ–¹æ³•å¯¹äºŽç†è§£å¦‚ä½•é€‰æ‹©ç®—æ³•å’Œæ‰‹å¤´æ•°æ®çš„æ­£ç¡®ç»„åˆæ˜¯å¿…è¦çš„ã€‚

å› æ­¤ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æŽ¢è®¨å¦‚ä½•æ¯”è¾ƒ ML æ¨¡åž‹å’Œç®—æ³•ã€‚

## æ¨¡åž‹é€‰æ‹©çš„æŒ‘æˆ˜

æ¯ä¸ªæ¨¡åž‹æˆ–ä»»ä½•æœºå™¨å­¦ä¹ ç®—æ³•éƒ½æœ‰å‡ ä¸ªä»¥ä¸åŒæ–¹å¼å¤„ç†æ•°æ®çš„ç‰¹å¾ã€‚é€šå¸¸ï¼Œæ ¹æ®ä¹‹å‰çš„å®žéªŒé˜¶æ®µï¼Œè¾“å…¥è¿™äº›ç®—æ³•çš„æ•°æ®ä¹Ÿæ˜¯ä¸åŒçš„ã€‚ä½†æ˜¯ï¼Œç”±äºŽæœºå™¨å­¦ä¹ å›¢é˜Ÿå’Œå¼€å‘äººå‘˜é€šå¸¸ä¼šè®°å½•ä»–ä»¬çš„å®žéªŒï¼Œå› æ­¤æœ‰è¶³å¤Ÿçš„æ•°æ®å¯ä¾›æ¯”è¾ƒã€‚

æŒ‘æˆ˜åœ¨äºŽç†è§£å“ªäº›å‚æ•°ã€æ•°æ®å’Œå…ƒæ•°æ®å¿…é¡»è¢«è€ƒè™‘ä»¥è¾¾åˆ°æœ€ç»ˆçš„é€‰æ‹©ã€‚è¿™æ˜¯ä¸€ä¸ªç»å…¸çš„æ‚–è®ºï¼Œæœ‰å¤§é‡çš„ç»†èŠ‚å´ä¸æ¸…æ™°ã€‚

æ›´å…·æŒ‘æˆ˜æ€§çš„æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ä¸€ä¸ªå…·æœ‰é«˜å€¼çš„å‚æ•°ï¼Œæ¯”å¦‚è¯´ä¸€ä¸ªè¾ƒé«˜çš„åº¦é‡åˆ†æ•°ï¼Œæ˜¯å¦å®žé™…ä¸Šæ„å‘³ç€è¯¥æ¨¡åž‹æ¯”ä¸€ä¸ªå…·æœ‰è¾ƒä½Žåˆ†æ•°çš„æ¨¡åž‹æ›´å¥½ï¼Œæˆ–è€…å®ƒæ˜¯å¦åªæ˜¯ç”±ç»Ÿè®¡åå·®æˆ–é”™è¯¯çš„åº¦é‡è®¾è®¡å¼•èµ·çš„ã€‚

[Continue reading ->](/web/20220928202143/https://neptune.ai/blog/how-to-compare-machine-learning-models-and-algorithms)

* * *